{"version":3,"file":"content.60540c10.js","sources":["../../src/views/cms/content/content.vue"],"sourcesContent":["<template>\n  <div class=\"page-main\">\n    <div class=\"operate-box\">\n      <div class=\"operate-btns\">\n        <el-button type=\"primary\" @click=\"handleAdd()\">新增</el-button>\n      </div>\n      <el-button type=\"primary\" icon=\"Refresh\" @click=\"() => { form.resetFields(); getList() }\" />\n    </div>\n\n    <div class=\"filter-box\">\n      <el-form ref=\"form\" class=\"filter-form\" :model=\"list.query\" label-width=\"80px\" inline>\n        <el-form-item label=\"昵称\" prop=\"nickname\">\n          <el-input v-model=\"list.query.nickname\" />\n        </el-form-item>\n        <el-form-item label=\"用户名\" prop=\"username\">\n          <el-input v-model=\"list.query.username\" />\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"getList\">搜索</el-button>\n          <el-button type=\"primary\" @click=\"() => { form.resetFields(); }\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n\n    <el-table v-loading=\"list.load\" :data=\"list.data\" border size=\"small\">\n      <el-table-column prop=\"id\" label=\"ID\" width=\"60\" align=\"center\" />\n      <el-table-column prop=\"title\" label=\"标题\" align=\"center\" />\n      <el-table-column prop=\"status\" label=\"状态\" align=\"center\">\n        <template #default=\"scope\">\n          <el-tag\n            v-if=\"scope.row.status === 'up_rack'\"\n          >{{ settingStore.parseByOption(scope.row.status, 'content_state') }}</el-tag>\n          <el-tag\n            v-else-if=\"scope.row.status === 'down_rack'\"\n            type=\"danger\"\n          >{{ settingStore.parseByOption(scope.row.status, 'content_state') }}</el-tag>\n          <el-tag\n            v-else\n            type=\"warning\"\n          >{{ settingStore.parseByOption(scope.row.status, 'content_state') }}</el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"recom\" label=\"推荐指数\" align=\"center\" />\n      <el-table-column prop=\"scan\" label=\"浏览量\" align=\"center\" />\n      <el-table-column prop=\"top\" label=\"置顶\" align=\"center\">\n        <template #default=\"scope\">\n          <el-tag\n            effect=\"dark\"\n            :type=\"scope.row.top ? 'success' : 'danger'\"\n          >{{ scope.row.top ? '是' : '否' }}</el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"ctime\" label=\"创建时间\" align=\"center\" />\n      <el-table-column label=\"操作\" align=\"center\">\n        <template #default=\"scope\">\n          <el-button @click=\"handleAdd(scope.row)\">编辑</el-button>\n          <el-button type=\"danger\" @click=\"handleDelete([scope.row.id], 'blog/content')\">删除</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <div class=\"pagination\">\n      <el-pagination\n        v-model:currentPage=\"list.query.page\"\n        v-model:page-size=\"list.query.limit\"\n        :page-sizes=\"[15, 20, 50, 100]\"\n        small\n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"list.query.total\"\n        @size-change=\"getList\"\n        @current-change=\"getList\"\n      />\n    </div>\n\n    <content-dialog v-if=\"dialogData.visible\" :dialog-data=\"dialogData\" />\n  </div>\n</template>\n\n<script lang='ts'>\nimport { requestPages } from '@/api/cms/content';\nimport { defineComponent, reactive, ref } from 'vue';\nimport { openDialog, handleDelete } from '@/api/base';\nimport ContentDialog from './components/contentDialog.vue';\nimport { emitter } from '@/utils/mitt';\nimport { useTagViewStore } from '@/store/modules/tagView';\nimport { useSettingStore } from '@/store/modules/setting';\n\nexport default defineComponent({\n  name: 'Content',\n  components: {\n    ContentDialog\n  },\n  setup() {\n    let form = ref();\n    const tagStore = useTagViewStore();\n    const settingStore = useSettingStore();\n\n    let dialogData = reactive<DialogData<Content.ContentRow | {}>>({\n      visible: false,\n      title: '',\n      data: {}\n    });\n    let list = reactive<TableList<Content.ContentRow>>({\n      data: [],\n      load: false,\n      query: {\n        page: 1,\n        limit: 15,\n        total: 0,\n        orderBy: ['+ctime', '+id'],\n      }\n    });\n\n    const getList = async () => {\n      try {\n        list.load = true;\n        const { code, result } = await requestPages(list.query);\n        list.data = result.rows;\n        list.query.total = result.total;\n        list.load = false;\n      } catch (error) {\n        list.load = false;\n      }\n    };\n    getList();\n\n    const handleAdd = (row?: Content.ContentRow) => {\n      tagStore.handleOpen({\n        title: '文章',\n        path: '/blog/content/add',\n        query: { id: row?.id },\n        affix: true,\n        active: true,\n      });\n    };\n\n    emitter.on('list-reload', (module) => {\n      if (module === 'blog/content') getList();\n    });\n\n    return {\n      list,\n      form,\n      dialogData,\n      tagStore,\n      settingStore,\n      handleAdd,\n      getList,\n      openDialog,\n      handleDelete\n    };\n  }\n});\n</script>\n\n<style lang='less' scoped>\n</style>\n"],"names":["_openBlock","_createElementBlock","_createElementVNode","_createVNode","_withCtx","_createBlock","_createTextVNode","_toDisplayString","_createCommentVNode"],"mappings":"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"}