import{d as E,r as C,a as L,ag as $,ah as w,ai as F,aj as M,f as N,ae as V,o as d,b as m,m as h,e as u,w as _,C as q,k as b,F as D,H as f,t as k,l as g,a8 as z}from"./vendor.628a587a.js";/* empty css                   *//* empty css                *//* empty css                    */import{r as O}from"./category.52e5baaf.js";import T from"./categoryDialog.7c8240c3.js";import{e as U,o as P,h as S}from"./base.cbd3d2de.js";import{_ as j}from"./index.6b964819.js";/* empty css                  *//* empty css                     *//* empty css                        */import"./lodash.6a43960b.js";const B="blog/category",H=E({name:"Category",components:{CategoryDialog:T},setup(){let e=C({}),p=L(""),v=C({visible:!1,title:"",data:{}}),s=C({data:[],load:!1,query:{limit:20,page:1,total:0,attrs:"all"}});const y=(a,n)=>{let l=[];for(const o of n)if(o.pid===a.id){let r=y(o,n);r.length&&(o.children=r),l.push(o)}return l.length&&(a.children=l),l},c=async()=>{try{s.load=!0;const{code:a,result:n}=await O(s.query);n.sort((o,r)=>o.sort-r.sort);const l=[...new Set(n.map(o=>o.group))].map(o=>({name:o,children:[]}));for(const o of l){let r=[],t=[];for(const i of n)i.group===o.name&&(r.push(i),i.pid===0&&t.push(i));for(const i of t)i.children=y(i,r);o.children.push(...t)}s.data=l,s.load=!1}catch{s.load=!1}};return c(),U.on("list-reload",a=>{a===B&&c()}),{parentCate:e,group:p,MODULE:B,list:s,dialogData:v,Edit:$,Delete:w,Plus:F,openDialog:P,handleDelete:S,getList:c}}}),I={class:"page-main"},R={class:"operate-box"},A={class:"operate-btns"},G=f("\u65B0\u589E"),J={class:"custom-tree-node"};function K(e,p,v,s,y,c){const a=z,n=M,l=N("category-dialog"),o=V;return d(),m("div",I,[h("div",R,[h("div",A,[u(a,{type:"primary",onClick:p[0]||(p[0]=r=>{e.group="",e.parentCate={},e.openDialog(e.dialogData,"\u65B0\u589E\u5206\u7C7B")})},{default:_(()=>[G]),_:1})]),u(a,{type:"primary",icon:"Refresh",onClick:p[1]||(p[1]=()=>{e.getList()})})]),q((d(),b(n,{data:e.list.data,"node-key":"id",props:{children:"children",label:"name"},"default-expand-all":"","expand-on-click-node":!1},{default:_(({node:r,data:t})=>[h("span",J,[t.id?(d(),m(D,{key:0},[f(k(t.id)+"_",1)],64)):g("",!0),f(" "+k(r.label)+" ",1),t.sort?(d(),m(D,{key:1},[f("("+k(t.sort)+")",1)],64)):g("",!0),u(a,{type:"primary",icon:e.Plus,size:"small",onClick:()=>{e.group=t.group||r.label,t.id&&(e.parentCate=t),e.openDialog(e.dialogData,"\u65B0\u589E\u5206\u7C7B")}},null,8,["icon","onClick"]),t.group?(d(),m(D,{key:2},[u(a,{type:"primary",icon:e.Edit,size:"small",onClick:i=>e.openDialog(e.dialogData,"\u7F16\u8F91\u5206\u7C7B",t)},null,8,["icon","onClick"]),u(a,{type:"danger",icon:e.Delete,size:"small",onClick:i=>e.handleDelete([t.id],e.MODULE)},null,8,["icon","onClick"])],64)):g("",!0)])]),_:1},8,["data"])),[[o,e.list.load]]),e.dialogData.visible?(d(),b(l,{key:0,"dialog-data":e.dialogData,module:e.MODULE,group:e.group,"parent-cate":e.parentCate},null,8,["dialog-data","module","group","parent-cate"])):g("",!0)])}var ie=j(H,[["render",K],["__scopeId","data-v-1c7bd8a8"]]);export{ie as default};
//# sourceMappingURL=category.4dbded12.js.map
